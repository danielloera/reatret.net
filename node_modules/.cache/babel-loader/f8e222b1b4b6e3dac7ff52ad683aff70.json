{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Util_1 = require(\"./Util\");\n\nvar Global_1 = require(\"./Global\");\n\nvar COMMA = ',',\n    OPEN_PAREN = '(',\n    CLOSE_PAREN = ')',\n    OPEN_PAREN_BRACKET = '([',\n    CLOSE_BRACKET_PAREN = '])',\n    SEMICOLON = ';',\n    DOUBLE_PAREN = '()',\n    EQUALS = '=',\n    CONTEXT_METHODS = ['arc', 'arcTo', 'beginPath', 'bezierCurveTo', 'clearRect', 'clip', 'closePath', 'createLinearGradient', 'createPattern', 'createRadialGradient', 'drawImage', 'fill', 'fillText', 'getImageData', 'createImageData', 'lineTo', 'moveTo', 'putImageData', 'quadraticCurveTo', 'rect', 'restore', 'rotate', 'save', 'scale', 'setLineDash', 'setTransform', 'stroke', 'strokeText', 'transform', 'translate'];\nvar CONTEXT_PROPERTIES = ['fillStyle', 'strokeStyle', 'shadowColor', 'shadowBlur', 'shadowOffsetX', 'shadowOffsetY', 'lineCap', 'lineDashOffset', 'lineJoin', 'lineWidth', 'miterLimit', 'font', 'textAlign', 'textBaseline', 'globalAlpha', 'globalCompositeOperation'];\nvar traceArrMax = 100;\n\nvar Context = function () {\n  function Context(canvas) {\n    this.canvas = canvas;\n    this._context = canvas._canvas.getContext('2d');\n\n    if (Global_1.Konva.enableTrace) {\n      this.traceArr = [];\n\n      this._enableTrace();\n    }\n  }\n\n  Context.prototype.fillShape = function (shape) {\n    if (shape.getFillEnabled()) {\n      this._fill(shape);\n    }\n  };\n\n  Context.prototype._fill = function (shape) {};\n\n  Context.prototype.strokeShape = function (shape) {\n    if (shape.getStrokeEnabled()) {\n      this._stroke(shape);\n    }\n  };\n\n  Context.prototype._stroke = function (shape) {};\n\n  Context.prototype.fillStrokeShape = function (shape) {\n    if (shape.getFillEnabled()) {\n      this._fill(shape);\n    }\n\n    if (shape.getStrokeEnabled()) {\n      this._stroke(shape);\n    }\n  };\n\n  Context.prototype.getTrace = function (relaxed) {\n    var traceArr = this.traceArr,\n        len = traceArr.length,\n        str = '',\n        n,\n        trace,\n        method,\n        args;\n\n    for (n = 0; n < len; n++) {\n      trace = traceArr[n];\n      method = trace.method;\n\n      if (method) {\n        args = trace.args;\n        str += method;\n\n        if (relaxed) {\n          str += DOUBLE_PAREN;\n        } else {\n          if (Util_1.Util._isArray(args[0])) {\n            str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;\n          } else {\n            str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;\n          }\n        }\n      } else {\n        str += trace.property;\n\n        if (!relaxed) {\n          str += EQUALS + trace.val;\n        }\n      }\n\n      str += SEMICOLON;\n    }\n\n    return str;\n  };\n\n  Context.prototype.clearTrace = function () {\n    this.traceArr = [];\n  };\n\n  Context.prototype._trace = function (str) {\n    var traceArr = this.traceArr,\n        len;\n    traceArr.push(str);\n    len = traceArr.length;\n\n    if (len >= traceArrMax) {\n      traceArr.shift();\n    }\n  };\n\n  Context.prototype.reset = function () {\n    var pixelRatio = this.getCanvas().getPixelRatio();\n    this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);\n  };\n\n  Context.prototype.getCanvas = function () {\n    return this.canvas;\n  };\n\n  Context.prototype.clear = function (bounds) {\n    var canvas = this.getCanvas();\n\n    if (bounds) {\n      this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);\n    } else {\n      this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);\n    }\n  };\n\n  Context.prototype._applyLineCap = function (shape) {\n    var lineCap = shape.getLineCap();\n\n    if (lineCap) {\n      this.setAttr('lineCap', lineCap);\n    }\n  };\n\n  Context.prototype._applyOpacity = function (shape) {\n    var absOpacity = shape.getAbsoluteOpacity();\n\n    if (absOpacity !== 1) {\n      this.setAttr('globalAlpha', absOpacity);\n    }\n  };\n\n  Context.prototype._applyLineJoin = function (shape) {\n    var lineJoin = shape.getLineJoin();\n\n    if (lineJoin) {\n      this.setAttr('lineJoin', lineJoin);\n    }\n  };\n\n  Context.prototype.setAttr = function (attr, val) {\n    this._context[attr] = val;\n  };\n\n  Context.prototype.arc = function (a0, a1, a2, a3, a4, a5) {\n    this._context.arc(a0, a1, a2, a3, a4, a5);\n  };\n\n  Context.prototype.arcTo = function (a0, a1, a2, a3, a4, a5) {\n    this._context.arc(a0, a1, a2, a3, a4, a5);\n  };\n\n  Context.prototype.beginPath = function () {\n    this._context.beginPath();\n  };\n\n  Context.prototype.bezierCurveTo = function (a0, a1, a2, a3, a4, a5) {\n    this._context.bezierCurveTo(a0, a1, a2, a3, a4, a5);\n  };\n\n  Context.prototype.clearRect = function (a0, a1, a2, a3) {\n    this._context.clearRect(a0, a1, a2, a3);\n  };\n\n  Context.prototype.clip = function () {\n    this._context.clip();\n  };\n\n  Context.prototype.closePath = function () {\n    this._context.closePath();\n  };\n\n  Context.prototype.createImageData = function (a0, a1) {\n    var a = arguments;\n\n    if (a.length === 2) {\n      return this._context.createImageData(a0, a1);\n    } else if (a.length === 1) {\n      return this._context.createImageData(a0);\n    }\n  };\n\n  Context.prototype.createLinearGradient = function (a0, a1, a2, a3) {\n    return this._context.createLinearGradient(a0, a1, a2, a3);\n  };\n\n  Context.prototype.createPattern = function (a0, a1) {\n    return this._context.createPattern(a0, a1);\n  };\n\n  Context.prototype.createRadialGradient = function (a0, a1, a2, a3, a4, a5) {\n    return this._context.createRadialGradient(a0, a1, a2, a3, a4, a5);\n  };\n\n  Context.prototype.drawImage = function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n    var a = arguments,\n        _context = this._context;\n\n    if (a.length === 3) {\n      _context.drawImage(a0, a1, a2);\n    } else if (a.length === 5) {\n      _context.drawImage(a0, a1, a2, a3, a4);\n    } else if (a.length === 9) {\n      _context.drawImage(a0, a1, a2, a3, a4, a5, a6, a7, a8);\n    }\n  };\n\n  Context.prototype.isPointInPath = function (x, y) {\n    return this._context.isPointInPath(x, y);\n  };\n\n  Context.prototype.fill = function () {\n    this._context.fill();\n  };\n\n  Context.prototype.fillRect = function (x, y, width, height) {\n    this._context.fillRect(x, y, width, height);\n  };\n\n  Context.prototype.strokeRect = function (x, y, width, height) {\n    this._context.strokeRect(x, y, width, height);\n  };\n\n  Context.prototype.fillText = function (a0, a1, a2) {\n    this._context.fillText(a0, a1, a2);\n  };\n\n  Context.prototype.measureText = function (text) {\n    return this._context.measureText(text);\n  };\n\n  Context.prototype.getImageData = function (a0, a1, a2, a3) {\n    return this._context.getImageData(a0, a1, a2, a3);\n  };\n\n  Context.prototype.lineTo = function (a0, a1) {\n    this._context.lineTo(a0, a1);\n  };\n\n  Context.prototype.moveTo = function (a0, a1) {\n    this._context.moveTo(a0, a1);\n  };\n\n  Context.prototype.rect = function (a0, a1, a2, a3) {\n    this._context.rect(a0, a1, a2, a3);\n  };\n\n  Context.prototype.putImageData = function (a0, a1, a2) {\n    this._context.putImageData(a0, a1, a2);\n  };\n\n  Context.prototype.quadraticCurveTo = function (a0, a1, a2, a3) {\n    this._context.quadraticCurveTo(a0, a1, a2, a3);\n  };\n\n  Context.prototype.restore = function () {\n    this._context.restore();\n  };\n\n  Context.prototype.rotate = function (a0) {\n    this._context.rotate(a0);\n  };\n\n  Context.prototype.save = function () {\n    this._context.save();\n  };\n\n  Context.prototype.scale = function (a0, a1) {\n    this._context.scale(a0, a1);\n  };\n\n  Context.prototype.setLineDash = function (a0) {\n    if (this._context.setLineDash) {\n      this._context.setLineDash(a0);\n    } else if ('mozDash' in this._context) {\n      this._context['mozDash'] = a0;\n    } else if ('webkitLineDash' in this._context) {\n      this._context['webkitLineDash'] = a0;\n    }\n  };\n\n  Context.prototype.getLineDash = function () {\n    return this._context.getLineDash();\n  };\n\n  Context.prototype.setTransform = function (a0, a1, a2, a3, a4, a5) {\n    this._context.setTransform(a0, a1, a2, a3, a4, a5);\n  };\n\n  Context.prototype.stroke = function () {\n    this._context.stroke();\n  };\n\n  Context.prototype.strokeText = function (a0, a1, a2, a3) {\n    this._context.strokeText(a0, a1, a2, a3);\n  };\n\n  Context.prototype.transform = function (a0, a1, a2, a3, a4, a5) {\n    this._context.transform(a0, a1, a2, a3, a4, a5);\n  };\n\n  Context.prototype.translate = function (a0, a1) {\n    this._context.translate(a0, a1);\n  };\n\n  Context.prototype._enableTrace = function () {\n    var that = this,\n        len = CONTEXT_METHODS.length,\n        _simplifyArray = Util_1.Util._simplifyArray,\n        origSetter = this.setAttr,\n        n,\n        args;\n\n    var func = function func(methodName) {\n      var origMethod = that[methodName],\n          ret;\n\n      that[methodName] = function () {\n        args = _simplifyArray(Array.prototype.slice.call(arguments, 0));\n        ret = origMethod.apply(that, arguments);\n\n        that._trace({\n          method: methodName,\n          args: args\n        });\n\n        return ret;\n      };\n    };\n\n    for (n = 0; n < len; n++) {\n      func(CONTEXT_METHODS[n]);\n    }\n\n    that.setAttr = function () {\n      origSetter.apply(that, arguments);\n      var prop = arguments[0];\n      var val = arguments[1];\n\n      if (prop === 'shadowOffsetX' || prop === 'shadowOffsetY' || prop === 'shadowBlur') {\n        val = val / this.canvas.getPixelRatio();\n      }\n\n      that._trace({\n        property: prop,\n        val: val\n      });\n    };\n  };\n\n  Context.prototype._applyGlobalCompositeOperation = function (node) {\n    var globalCompositeOperation = node.getGlobalCompositeOperation();\n\n    if (globalCompositeOperation !== 'source-over') {\n      this.setAttr('globalCompositeOperation', globalCompositeOperation);\n    }\n  };\n\n  return Context;\n}();\n\nexports.Context = Context;\nCONTEXT_PROPERTIES.forEach(function (prop) {\n  Object.defineProperty(Context.prototype, prop, {\n    get: function get() {\n      return this._context[prop];\n    },\n    set: function set(val) {\n      this._context[prop] = val;\n    }\n  });\n});\n\nvar SceneContext = function (_super) {\n  __extends(SceneContext, _super);\n\n  function SceneContext() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SceneContext.prototype._fillColor = function (shape) {\n    var fill = shape.fill();\n    this.setAttr('fillStyle', fill);\n\n    shape._fillFunc(this);\n  };\n\n  SceneContext.prototype._fillPattern = function (shape) {\n    var fillPatternX = shape.getFillPatternX(),\n        fillPatternY = shape.getFillPatternY(),\n        fillPatternScaleX = shape.getFillPatternScaleX(),\n        fillPatternScaleY = shape.getFillPatternScaleY(),\n        fillPatternRotation = Global_1.Konva.getAngle(shape.getFillPatternRotation()),\n        fillPatternOffsetX = shape.getFillPatternOffsetX(),\n        fillPatternOffsetY = shape.getFillPatternOffsetY();\n\n    if (fillPatternX || fillPatternY) {\n      this.translate(fillPatternX || 0, fillPatternY || 0);\n    }\n\n    if (fillPatternRotation) {\n      this.rotate(fillPatternRotation);\n    }\n\n    if (fillPatternScaleX || fillPatternScaleY) {\n      this.scale(fillPatternScaleX, fillPatternScaleY);\n    }\n\n    if (fillPatternOffsetX || fillPatternOffsetY) {\n      this.translate(-1 * fillPatternOffsetX, -1 * fillPatternOffsetY);\n    }\n\n    this.setAttr('fillStyle', shape._getFillPattern());\n\n    shape._fillFunc(this);\n  };\n\n  SceneContext.prototype._fillLinearGradient = function (shape) {\n    var grd = shape._getLinearGradient();\n\n    if (grd) {\n      this.setAttr('fillStyle', grd);\n\n      shape._fillFunc(this);\n    }\n  };\n\n  SceneContext.prototype._fillRadialGradient = function (shape) {\n    var grd = shape._getRadialGradient();\n\n    if (grd) {\n      this.setAttr('fillStyle', grd);\n\n      shape._fillFunc(this);\n    }\n  };\n\n  SceneContext.prototype._fill = function (shape) {\n    var hasColor = shape.fill(),\n        fillPriority = shape.getFillPriority();\n\n    if (hasColor && fillPriority === 'color') {\n      this._fillColor(shape);\n\n      return;\n    }\n\n    var hasPattern = shape.getFillPatternImage();\n\n    if (hasPattern && fillPriority === 'pattern') {\n      this._fillPattern(shape);\n\n      return;\n    }\n\n    var hasLinearGradient = shape.getFillLinearGradientColorStops();\n\n    if (hasLinearGradient && fillPriority === 'linear-gradient') {\n      this._fillLinearGradient(shape);\n\n      return;\n    }\n\n    var hasRadialGradient = shape.getFillRadialGradientColorStops();\n\n    if (hasRadialGradient && fillPriority === 'radial-gradient') {\n      this._fillRadialGradient(shape);\n\n      return;\n    }\n\n    if (hasColor) {\n      this._fillColor(shape);\n    } else if (hasPattern) {\n      this._fillPattern(shape);\n    } else if (hasLinearGradient) {\n      this._fillLinearGradient(shape);\n    } else if (hasRadialGradient) {\n      this._fillRadialGradient(shape);\n    }\n  };\n\n  SceneContext.prototype._strokeLinearGradient = function (shape) {\n    var start = shape.getStrokeLinearGradientStartPoint(),\n        end = shape.getStrokeLinearGradientEndPoint(),\n        colorStops = shape.getStrokeLinearGradientColorStops(),\n        grd = this.createLinearGradient(start.x, start.y, end.x, end.y);\n\n    if (colorStops) {\n      for (var n = 0; n < colorStops.length; n += 2) {\n        grd.addColorStop(colorStops[n], colorStops[n + 1]);\n      }\n\n      this.setAttr('strokeStyle', grd);\n    }\n  };\n\n  SceneContext.prototype._stroke = function (shape) {\n    var dash = shape.dash(),\n        strokeScaleEnabled = shape.getStrokeScaleEnabled();\n\n    if (shape.hasStroke()) {\n      if (!strokeScaleEnabled) {\n        this.save();\n        var pixelRatio = this.getCanvas().getPixelRatio();\n        this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n      }\n\n      this._applyLineCap(shape);\n\n      if (dash && shape.dashEnabled()) {\n        this.setLineDash(dash);\n        this.setAttr('lineDashOffset', shape.dashOffset());\n      }\n\n      this.setAttr('lineWidth', shape.strokeWidth());\n\n      if (!shape.getShadowForStrokeEnabled()) {\n        this.setAttr('shadowColor', 'rgba(0,0,0,0)');\n      }\n\n      var hasLinearGradient = shape.getStrokeLinearGradientColorStops();\n\n      if (hasLinearGradient) {\n        this._strokeLinearGradient(shape);\n      } else {\n        this.setAttr('strokeStyle', shape.stroke());\n      }\n\n      shape._strokeFunc(this);\n\n      if (!strokeScaleEnabled) {\n        this.restore();\n      }\n    }\n  };\n\n  SceneContext.prototype._applyShadow = function (shape) {\n    var util = Util_1.Util,\n        color = util.get(shape.getShadowRGBA(), 'black'),\n        blur = util.get(shape.getShadowBlur(), 5),\n        offset = util.get(shape.getShadowOffset(), {\n      x: 0,\n      y: 0\n    }),\n        scale = shape.getAbsoluteScale(),\n        ratio = this.canvas.getPixelRatio(),\n        scaleX = scale.x * ratio,\n        scaleY = scale.y * ratio;\n    this.setAttr('shadowColor', color);\n    this.setAttr('shadowBlur', blur * Math.min(Math.abs(scaleX), Math.abs(scaleY)));\n    this.setAttr('shadowOffsetX', offset.x * scaleX);\n    this.setAttr('shadowOffsetY', offset.y * scaleY);\n  };\n\n  return SceneContext;\n}(Context);\n\nexports.SceneContext = SceneContext;\n\nvar HitContext = function (_super) {\n  __extends(HitContext, _super);\n\n  function HitContext() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  HitContext.prototype._fill = function (shape) {\n    this.save();\n    this.setAttr('fillStyle', shape.colorKey);\n\n    shape._fillFuncHit(this);\n\n    this.restore();\n  };\n\n  HitContext.prototype._stroke = function (shape) {\n    if (shape.hasStroke() && shape.hitStrokeWidth()) {\n      var strokeScaleEnabled = shape.getStrokeScaleEnabled();\n\n      if (!strokeScaleEnabled) {\n        this.save();\n        var pixelRatio = this.getCanvas().getPixelRatio();\n        this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n      }\n\n      this._applyLineCap(shape);\n\n      var hitStrokeWidth = shape.hitStrokeWidth();\n      var strokeWidth = hitStrokeWidth === 'auto' ? shape.strokeWidth() : hitStrokeWidth;\n      this.setAttr('lineWidth', strokeWidth);\n      this.setAttr('strokeStyle', shape.colorKey);\n\n      shape._strokeFuncHit(this);\n\n      if (!strokeScaleEnabled) {\n        this.restore();\n      }\n    }\n  };\n\n  return HitContext;\n}(Context);\n\nexports.HitContext = HitContext;","map":{"version":3,"sources":["/home/daniel/reatret.net/react-app/node_modules/konva/lib/Context.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","Util_1","require","Global_1","COMMA","OPEN_PAREN","CLOSE_PAREN","OPEN_PAREN_BRACKET","CLOSE_BRACKET_PAREN","SEMICOLON","DOUBLE_PAREN","EQUALS","CONTEXT_METHODS","CONTEXT_PROPERTIES","traceArrMax","Context","canvas","_context","_canvas","getContext","Konva","enableTrace","traceArr","_enableTrace","fillShape","shape","getFillEnabled","_fill","strokeShape","getStrokeEnabled","_stroke","fillStrokeShape","getTrace","relaxed","len","length","str","n","trace","method","args","Util","_isArray","join","property","val","clearTrace","_trace","push","shift","reset","pixelRatio","getCanvas","getPixelRatio","setTransform","clear","bounds","clearRect","x","y","width","height","getWidth","getHeight","_applyLineCap","lineCap","getLineCap","setAttr","_applyOpacity","absOpacity","getAbsoluteOpacity","_applyLineJoin","lineJoin","getLineJoin","attr","arc","a0","a1","a2","a3","a4","a5","arcTo","beginPath","bezierCurveTo","clip","closePath","createImageData","a","arguments","createLinearGradient","createPattern","createRadialGradient","drawImage","a6","a7","a8","isPointInPath","fill","fillRect","strokeRect","fillText","measureText","text","getImageData","lineTo","moveTo","rect","putImageData","quadraticCurveTo","restore","rotate","save","scale","setLineDash","getLineDash","stroke","strokeText","transform","translate","that","_simplifyArray","origSetter","func","methodName","origMethod","ret","slice","call","apply","prop","_applyGlobalCompositeOperation","node","globalCompositeOperation","getGlobalCompositeOperation","forEach","get","set","SceneContext","_super","_fillColor","_fillFunc","_fillPattern","fillPatternX","getFillPatternX","fillPatternY","getFillPatternY","fillPatternScaleX","getFillPatternScaleX","fillPatternScaleY","getFillPatternScaleY","fillPatternRotation","getAngle","getFillPatternRotation","fillPatternOffsetX","getFillPatternOffsetX","fillPatternOffsetY","getFillPatternOffsetY","_getFillPattern","_fillLinearGradient","grd","_getLinearGradient","_fillRadialGradient","_getRadialGradient","hasColor","fillPriority","getFillPriority","hasPattern","getFillPatternImage","hasLinearGradient","getFillLinearGradientColorStops","hasRadialGradient","getFillRadialGradientColorStops","_strokeLinearGradient","start","getStrokeLinearGradientStartPoint","end","getStrokeLinearGradientEndPoint","colorStops","getStrokeLinearGradientColorStops","addColorStop","dash","strokeScaleEnabled","getStrokeScaleEnabled","hasStroke","dashEnabled","dashOffset","strokeWidth","getShadowForStrokeEnabled","_strokeFunc","_applyShadow","util","color","getShadowRGBA","blur","getShadowBlur","offset","getShadowOffset","getAbsoluteScale","ratio","scaleX","scaleY","Math","min","abs","HitContext","colorKey","_fillFuncHit","hitStrokeWidth","_strokeFuncHit"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Util_1 = require(\"./Util\");\nvar Global_1 = require(\"./Global\");\nvar COMMA = ',', OPEN_PAREN = '(', CLOSE_PAREN = ')', OPEN_PAREN_BRACKET = '([', CLOSE_BRACKET_PAREN = '])', SEMICOLON = ';', DOUBLE_PAREN = '()', EQUALS = '=', CONTEXT_METHODS = [\n    'arc',\n    'arcTo',\n    'beginPath',\n    'bezierCurveTo',\n    'clearRect',\n    'clip',\n    'closePath',\n    'createLinearGradient',\n    'createPattern',\n    'createRadialGradient',\n    'drawImage',\n    'fill',\n    'fillText',\n    'getImageData',\n    'createImageData',\n    'lineTo',\n    'moveTo',\n    'putImageData',\n    'quadraticCurveTo',\n    'rect',\n    'restore',\n    'rotate',\n    'save',\n    'scale',\n    'setLineDash',\n    'setTransform',\n    'stroke',\n    'strokeText',\n    'transform',\n    'translate'\n];\nvar CONTEXT_PROPERTIES = [\n    'fillStyle',\n    'strokeStyle',\n    'shadowColor',\n    'shadowBlur',\n    'shadowOffsetX',\n    'shadowOffsetY',\n    'lineCap',\n    'lineDashOffset',\n    'lineJoin',\n    'lineWidth',\n    'miterLimit',\n    'font',\n    'textAlign',\n    'textBaseline',\n    'globalAlpha',\n    'globalCompositeOperation'\n];\nvar traceArrMax = 100;\nvar Context = (function () {\n    function Context(canvas) {\n        this.canvas = canvas;\n        this._context = canvas._canvas.getContext('2d');\n        if (Global_1.Konva.enableTrace) {\n            this.traceArr = [];\n            this._enableTrace();\n        }\n    }\n    Context.prototype.fillShape = function (shape) {\n        if (shape.getFillEnabled()) {\n            this._fill(shape);\n        }\n    };\n    Context.prototype._fill = function (shape) {\n    };\n    Context.prototype.strokeShape = function (shape) {\n        if (shape.getStrokeEnabled()) {\n            this._stroke(shape);\n        }\n    };\n    Context.prototype._stroke = function (shape) {\n    };\n    Context.prototype.fillStrokeShape = function (shape) {\n        if (shape.getFillEnabled()) {\n            this._fill(shape);\n        }\n        if (shape.getStrokeEnabled()) {\n            this._stroke(shape);\n        }\n    };\n    Context.prototype.getTrace = function (relaxed) {\n        var traceArr = this.traceArr, len = traceArr.length, str = '', n, trace, method, args;\n        for (n = 0; n < len; n++) {\n            trace = traceArr[n];\n            method = trace.method;\n            if (method) {\n                args = trace.args;\n                str += method;\n                if (relaxed) {\n                    str += DOUBLE_PAREN;\n                }\n                else {\n                    if (Util_1.Util._isArray(args[0])) {\n                        str += OPEN_PAREN_BRACKET + args.join(COMMA) + CLOSE_BRACKET_PAREN;\n                    }\n                    else {\n                        str += OPEN_PAREN + args.join(COMMA) + CLOSE_PAREN;\n                    }\n                }\n            }\n            else {\n                str += trace.property;\n                if (!relaxed) {\n                    str += EQUALS + trace.val;\n                }\n            }\n            str += SEMICOLON;\n        }\n        return str;\n    };\n    Context.prototype.clearTrace = function () {\n        this.traceArr = [];\n    };\n    Context.prototype._trace = function (str) {\n        var traceArr = this.traceArr, len;\n        traceArr.push(str);\n        len = traceArr.length;\n        if (len >= traceArrMax) {\n            traceArr.shift();\n        }\n    };\n    Context.prototype.reset = function () {\n        var pixelRatio = this.getCanvas().getPixelRatio();\n        this.setTransform(1 * pixelRatio, 0, 0, 1 * pixelRatio, 0, 0);\n    };\n    Context.prototype.getCanvas = function () {\n        return this.canvas;\n    };\n    Context.prototype.clear = function (bounds) {\n        var canvas = this.getCanvas();\n        if (bounds) {\n            this.clearRect(bounds.x || 0, bounds.y || 0, bounds.width || 0, bounds.height || 0);\n        }\n        else {\n            this.clearRect(0, 0, canvas.getWidth() / canvas.pixelRatio, canvas.getHeight() / canvas.pixelRatio);\n        }\n    };\n    Context.prototype._applyLineCap = function (shape) {\n        var lineCap = shape.getLineCap();\n        if (lineCap) {\n            this.setAttr('lineCap', lineCap);\n        }\n    };\n    Context.prototype._applyOpacity = function (shape) {\n        var absOpacity = shape.getAbsoluteOpacity();\n        if (absOpacity !== 1) {\n            this.setAttr('globalAlpha', absOpacity);\n        }\n    };\n    Context.prototype._applyLineJoin = function (shape) {\n        var lineJoin = shape.getLineJoin();\n        if (lineJoin) {\n            this.setAttr('lineJoin', lineJoin);\n        }\n    };\n    Context.prototype.setAttr = function (attr, val) {\n        this._context[attr] = val;\n    };\n    Context.prototype.arc = function (a0, a1, a2, a3, a4, a5) {\n        this._context.arc(a0, a1, a2, a3, a4, a5);\n    };\n    Context.prototype.arcTo = function (a0, a1, a2, a3, a4, a5) {\n        this._context.arc(a0, a1, a2, a3, a4, a5);\n    };\n    Context.prototype.beginPath = function () {\n        this._context.beginPath();\n    };\n    Context.prototype.bezierCurveTo = function (a0, a1, a2, a3, a4, a5) {\n        this._context.bezierCurveTo(a0, a1, a2, a3, a4, a5);\n    };\n    Context.prototype.clearRect = function (a0, a1, a2, a3) {\n        this._context.clearRect(a0, a1, a2, a3);\n    };\n    Context.prototype.clip = function () {\n        this._context.clip();\n    };\n    Context.prototype.closePath = function () {\n        this._context.closePath();\n    };\n    Context.prototype.createImageData = function (a0, a1) {\n        var a = arguments;\n        if (a.length === 2) {\n            return this._context.createImageData(a0, a1);\n        }\n        else if (a.length === 1) {\n            return this._context.createImageData(a0);\n        }\n    };\n    Context.prototype.createLinearGradient = function (a0, a1, a2, a3) {\n        return this._context.createLinearGradient(a0, a1, a2, a3);\n    };\n    Context.prototype.createPattern = function (a0, a1) {\n        return this._context.createPattern(a0, a1);\n    };\n    Context.prototype.createRadialGradient = function (a0, a1, a2, a3, a4, a5) {\n        return this._context.createRadialGradient(a0, a1, a2, a3, a4, a5);\n    };\n    Context.prototype.drawImage = function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n        var a = arguments, _context = this._context;\n        if (a.length === 3) {\n            _context.drawImage(a0, a1, a2);\n        }\n        else if (a.length === 5) {\n            _context.drawImage(a0, a1, a2, a3, a4);\n        }\n        else if (a.length === 9) {\n            _context.drawImage(a0, a1, a2, a3, a4, a5, a6, a7, a8);\n        }\n    };\n    Context.prototype.isPointInPath = function (x, y) {\n        return this._context.isPointInPath(x, y);\n    };\n    Context.prototype.fill = function () {\n        this._context.fill();\n    };\n    Context.prototype.fillRect = function (x, y, width, height) {\n        this._context.fillRect(x, y, width, height);\n    };\n    Context.prototype.strokeRect = function (x, y, width, height) {\n        this._context.strokeRect(x, y, width, height);\n    };\n    Context.prototype.fillText = function (a0, a1, a2) {\n        this._context.fillText(a0, a1, a2);\n    };\n    Context.prototype.measureText = function (text) {\n        return this._context.measureText(text);\n    };\n    Context.prototype.getImageData = function (a0, a1, a2, a3) {\n        return this._context.getImageData(a0, a1, a2, a3);\n    };\n    Context.prototype.lineTo = function (a0, a1) {\n        this._context.lineTo(a0, a1);\n    };\n    Context.prototype.moveTo = function (a0, a1) {\n        this._context.moveTo(a0, a1);\n    };\n    Context.prototype.rect = function (a0, a1, a2, a3) {\n        this._context.rect(a0, a1, a2, a3);\n    };\n    Context.prototype.putImageData = function (a0, a1, a2) {\n        this._context.putImageData(a0, a1, a2);\n    };\n    Context.prototype.quadraticCurveTo = function (a0, a1, a2, a3) {\n        this._context.quadraticCurveTo(a0, a1, a2, a3);\n    };\n    Context.prototype.restore = function () {\n        this._context.restore();\n    };\n    Context.prototype.rotate = function (a0) {\n        this._context.rotate(a0);\n    };\n    Context.prototype.save = function () {\n        this._context.save();\n    };\n    Context.prototype.scale = function (a0, a1) {\n        this._context.scale(a0, a1);\n    };\n    Context.prototype.setLineDash = function (a0) {\n        if (this._context.setLineDash) {\n            this._context.setLineDash(a0);\n        }\n        else if ('mozDash' in this._context) {\n            this._context['mozDash'] = a0;\n        }\n        else if ('webkitLineDash' in this._context) {\n            this._context['webkitLineDash'] = a0;\n        }\n    };\n    Context.prototype.getLineDash = function () {\n        return this._context.getLineDash();\n    };\n    Context.prototype.setTransform = function (a0, a1, a2, a3, a4, a5) {\n        this._context.setTransform(a0, a1, a2, a3, a4, a5);\n    };\n    Context.prototype.stroke = function () {\n        this._context.stroke();\n    };\n    Context.prototype.strokeText = function (a0, a1, a2, a3) {\n        this._context.strokeText(a0, a1, a2, a3);\n    };\n    Context.prototype.transform = function (a0, a1, a2, a3, a4, a5) {\n        this._context.transform(a0, a1, a2, a3, a4, a5);\n    };\n    Context.prototype.translate = function (a0, a1) {\n        this._context.translate(a0, a1);\n    };\n    Context.prototype._enableTrace = function () {\n        var that = this, len = CONTEXT_METHODS.length, _simplifyArray = Util_1.Util._simplifyArray, origSetter = this.setAttr, n, args;\n        var func = function (methodName) {\n            var origMethod = that[methodName], ret;\n            that[methodName] = function () {\n                args = _simplifyArray(Array.prototype.slice.call(arguments, 0));\n                ret = origMethod.apply(that, arguments);\n                that._trace({\n                    method: methodName,\n                    args: args\n                });\n                return ret;\n            };\n        };\n        for (n = 0; n < len; n++) {\n            func(CONTEXT_METHODS[n]);\n        }\n        that.setAttr = function () {\n            origSetter.apply(that, arguments);\n            var prop = arguments[0];\n            var val = arguments[1];\n            if (prop === 'shadowOffsetX' ||\n                prop === 'shadowOffsetY' ||\n                prop === 'shadowBlur') {\n                val = val / this.canvas.getPixelRatio();\n            }\n            that._trace({\n                property: prop,\n                val: val\n            });\n        };\n    };\n    Context.prototype._applyGlobalCompositeOperation = function (node) {\n        var globalCompositeOperation = node.getGlobalCompositeOperation();\n        if (globalCompositeOperation !== 'source-over') {\n            this.setAttr('globalCompositeOperation', globalCompositeOperation);\n        }\n    };\n    return Context;\n}());\nexports.Context = Context;\nCONTEXT_PROPERTIES.forEach(function (prop) {\n    Object.defineProperty(Context.prototype, prop, {\n        get: function () {\n            return this._context[prop];\n        },\n        set: function (val) {\n            this._context[prop] = val;\n        }\n    });\n});\nvar SceneContext = (function (_super) {\n    __extends(SceneContext, _super);\n    function SceneContext() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SceneContext.prototype._fillColor = function (shape) {\n        var fill = shape.fill();\n        this.setAttr('fillStyle', fill);\n        shape._fillFunc(this);\n    };\n    SceneContext.prototype._fillPattern = function (shape) {\n        var fillPatternX = shape.getFillPatternX(), fillPatternY = shape.getFillPatternY(), fillPatternScaleX = shape.getFillPatternScaleX(), fillPatternScaleY = shape.getFillPatternScaleY(), fillPatternRotation = Global_1.Konva.getAngle(shape.getFillPatternRotation()), fillPatternOffsetX = shape.getFillPatternOffsetX(), fillPatternOffsetY = shape.getFillPatternOffsetY();\n        if (fillPatternX || fillPatternY) {\n            this.translate(fillPatternX || 0, fillPatternY || 0);\n        }\n        if (fillPatternRotation) {\n            this.rotate(fillPatternRotation);\n        }\n        if (fillPatternScaleX || fillPatternScaleY) {\n            this.scale(fillPatternScaleX, fillPatternScaleY);\n        }\n        if (fillPatternOffsetX || fillPatternOffsetY) {\n            this.translate(-1 * fillPatternOffsetX, -1 * fillPatternOffsetY);\n        }\n        this.setAttr('fillStyle', shape._getFillPattern());\n        shape._fillFunc(this);\n    };\n    SceneContext.prototype._fillLinearGradient = function (shape) {\n        var grd = shape._getLinearGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    };\n    SceneContext.prototype._fillRadialGradient = function (shape) {\n        var grd = shape._getRadialGradient();\n        if (grd) {\n            this.setAttr('fillStyle', grd);\n            shape._fillFunc(this);\n        }\n    };\n    SceneContext.prototype._fill = function (shape) {\n        var hasColor = shape.fill(), fillPriority = shape.getFillPriority();\n        if (hasColor && fillPriority === 'color') {\n            this._fillColor(shape);\n            return;\n        }\n        var hasPattern = shape.getFillPatternImage();\n        if (hasPattern && fillPriority === 'pattern') {\n            this._fillPattern(shape);\n            return;\n        }\n        var hasLinearGradient = shape.getFillLinearGradientColorStops();\n        if (hasLinearGradient && fillPriority === 'linear-gradient') {\n            this._fillLinearGradient(shape);\n            return;\n        }\n        var hasRadialGradient = shape.getFillRadialGradientColorStops();\n        if (hasRadialGradient && fillPriority === 'radial-gradient') {\n            this._fillRadialGradient(shape);\n            return;\n        }\n        if (hasColor) {\n            this._fillColor(shape);\n        }\n        else if (hasPattern) {\n            this._fillPattern(shape);\n        }\n        else if (hasLinearGradient) {\n            this._fillLinearGradient(shape);\n        }\n        else if (hasRadialGradient) {\n            this._fillRadialGradient(shape);\n        }\n    };\n    SceneContext.prototype._strokeLinearGradient = function (shape) {\n        var start = shape.getStrokeLinearGradientStartPoint(), end = shape.getStrokeLinearGradientEndPoint(), colorStops = shape.getStrokeLinearGradientColorStops(), grd = this.createLinearGradient(start.x, start.y, end.x, end.y);\n        if (colorStops) {\n            for (var n = 0; n < colorStops.length; n += 2) {\n                grd.addColorStop(colorStops[n], colorStops[n + 1]);\n            }\n            this.setAttr('strokeStyle', grd);\n        }\n    };\n    SceneContext.prototype._stroke = function (shape) {\n        var dash = shape.dash(), strokeScaleEnabled = shape.getStrokeScaleEnabled();\n        if (shape.hasStroke()) {\n            if (!strokeScaleEnabled) {\n                this.save();\n                var pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            if (dash && shape.dashEnabled()) {\n                this.setLineDash(dash);\n                this.setAttr('lineDashOffset', shape.dashOffset());\n            }\n            this.setAttr('lineWidth', shape.strokeWidth());\n            if (!shape.getShadowForStrokeEnabled()) {\n                this.setAttr('shadowColor', 'rgba(0,0,0,0)');\n            }\n            var hasLinearGradient = shape.getStrokeLinearGradientColorStops();\n            if (hasLinearGradient) {\n                this._strokeLinearGradient(shape);\n            }\n            else {\n                this.setAttr('strokeStyle', shape.stroke());\n            }\n            shape._strokeFunc(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    };\n    SceneContext.prototype._applyShadow = function (shape) {\n        var util = Util_1.Util, color = util.get(shape.getShadowRGBA(), 'black'), blur = util.get(shape.getShadowBlur(), 5), offset = util.get(shape.getShadowOffset(), {\n            x: 0,\n            y: 0\n        }), scale = shape.getAbsoluteScale(), ratio = this.canvas.getPixelRatio(), scaleX = scale.x * ratio, scaleY = scale.y * ratio;\n        this.setAttr('shadowColor', color);\n        this.setAttr('shadowBlur', blur * Math.min(Math.abs(scaleX), Math.abs(scaleY)));\n        this.setAttr('shadowOffsetX', offset.x * scaleX);\n        this.setAttr('shadowOffsetY', offset.y * scaleY);\n    };\n    return SceneContext;\n}(Context));\nexports.SceneContext = SceneContext;\nvar HitContext = (function (_super) {\n    __extends(HitContext, _super);\n    function HitContext() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    HitContext.prototype._fill = function (shape) {\n        this.save();\n        this.setAttr('fillStyle', shape.colorKey);\n        shape._fillFuncHit(this);\n        this.restore();\n    };\n    HitContext.prototype._stroke = function (shape) {\n        if (shape.hasStroke() && shape.hitStrokeWidth()) {\n            var strokeScaleEnabled = shape.getStrokeScaleEnabled();\n            if (!strokeScaleEnabled) {\n                this.save();\n                var pixelRatio = this.getCanvas().getPixelRatio();\n                this.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n            }\n            this._applyLineCap(shape);\n            var hitStrokeWidth = shape.hitStrokeWidth();\n            var strokeWidth = hitStrokeWidth === 'auto' ? shape.strokeWidth() : hitStrokeWidth;\n            this.setAttr('lineWidth', strokeWidth);\n            this.setAttr('strokeStyle', shape.colorKey);\n            shape._strokeFuncHit(this);\n            if (!strokeScaleEnabled) {\n                this.restore();\n            }\n        }\n    };\n    return HitContext;\n}(Context));\nexports.HitContext = HitContext;\n"]},"metadata":{},"sourceType":"script"}