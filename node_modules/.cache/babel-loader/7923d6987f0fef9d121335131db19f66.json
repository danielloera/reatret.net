{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Util_1 = require(\"./Util\");\n\nvar Container_1 = require(\"./Container\");\n\nvar Node_1 = require(\"./Node\");\n\nvar Factory_1 = require(\"./Factory\");\n\nvar Canvas_1 = require(\"./Canvas\");\n\nvar BaseLayer = function (_super) {\n  __extends(BaseLayer, _super);\n\n  function BaseLayer(config) {\n    var _this = _super.call(this, config) || this;\n\n    _this.canvas = new Canvas_1.SceneCanvas();\n    _this._waitingForDraw = false;\n\n    _this.on('visibleChange', _this._checkVisibility);\n\n    _this._checkVisibility();\n\n    return _this;\n  }\n\n  BaseLayer.prototype.createPNGStream = function () {\n    var c = this.canvas._canvas;\n    return c.createPNGStream();\n  };\n\n  BaseLayer.prototype.getCanvas = function () {\n    return this.canvas;\n  };\n\n  BaseLayer.prototype.getHitCanvas = function () {\n    return this.hitCanvas;\n  };\n\n  BaseLayer.prototype.getContext = function () {\n    return this.getCanvas().getContext();\n  };\n\n  BaseLayer.prototype.clear = function (bounds) {\n    this.getContext().clear(bounds);\n    return this;\n  };\n\n  BaseLayer.prototype.setZIndex = function (index) {\n    _super.prototype.setZIndex.call(this, index);\n\n    var stage = this.getStage();\n\n    if (stage) {\n      stage.content.removeChild(this.getCanvas()._canvas);\n\n      if (index < stage.getChildren().length - 1) {\n        stage.content.insertBefore(this.getCanvas()._canvas, stage.getChildren()[index + 1].getCanvas()._canvas);\n      } else {\n        stage.content.appendChild(this.getCanvas()._canvas);\n      }\n    }\n\n    return this;\n  };\n\n  BaseLayer.prototype.moveToTop = function () {\n    Node_1.Node.prototype.moveToTop.call(this);\n    var stage = this.getStage();\n\n    if (stage) {\n      stage.content.removeChild(this.getCanvas()._canvas);\n      stage.content.appendChild(this.getCanvas()._canvas);\n    }\n\n    return true;\n  };\n\n  BaseLayer.prototype.moveUp = function () {\n    var moved = Node_1.Node.prototype.moveUp.call(this);\n\n    if (!moved) {\n      return false;\n    }\n\n    var stage = this.getStage();\n\n    if (!stage) {\n      return false;\n    }\n\n    stage.content.removeChild(this.getCanvas()._canvas);\n\n    if (this.index < stage.getChildren().length - 1) {\n      stage.content.insertBefore(this.getCanvas()._canvas, stage.getChildren()[this.index + 1].getCanvas()._canvas);\n    } else {\n      stage.content.appendChild(this.getCanvas()._canvas);\n    }\n\n    return true;\n  };\n\n  BaseLayer.prototype.moveDown = function () {\n    if (Node_1.Node.prototype.moveDown.call(this)) {\n      var stage = this.getStage();\n\n      if (stage) {\n        var children = stage.getChildren();\n        stage.content.removeChild(this.getCanvas()._canvas);\n        stage.content.insertBefore(this.getCanvas()._canvas, children[this.index + 1].getCanvas()._canvas);\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  BaseLayer.prototype.moveToBottom = function () {\n    if (Node_1.Node.prototype.moveToBottom.call(this)) {\n      var stage = this.getStage();\n\n      if (stage) {\n        var children = stage.getChildren();\n        stage.content.removeChild(this.getCanvas()._canvas);\n        stage.content.insertBefore(this.getCanvas()._canvas, children[1].getCanvas()._canvas);\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  BaseLayer.prototype.getLayer = function () {\n    return this;\n  };\n\n  BaseLayer.prototype.remove = function () {\n    var _canvas = this.getCanvas()._canvas;\n\n    Node_1.Node.prototype.remove.call(this);\n\n    if (_canvas && _canvas.parentNode && Util_1.Util._isInDocument(_canvas)) {\n      _canvas.parentNode.removeChild(_canvas);\n    }\n\n    return this;\n  };\n\n  BaseLayer.prototype.getStage = function () {\n    return this.parent;\n  };\n\n  BaseLayer.prototype.setSize = function (_a) {\n    var width = _a.width,\n        height = _a.height;\n    this.canvas.setSize(width, height);\n    return this;\n  };\n\n  BaseLayer.prototype._toKonvaCanvas = function (config) {\n    config = config || {};\n    config.width = config.width || this.getWidth();\n    config.height = config.height || this.getHeight();\n    config.x = config.x !== undefined ? config.x : this.x();\n    config.y = config.y !== undefined ? config.y : this.y();\n    return Node_1.Node.prototype._toKonvaCanvas.call(this, config);\n  };\n\n  BaseLayer.prototype._checkVisibility = function () {\n    var visible = this.visible();\n\n    if (visible) {\n      this.canvas._canvas.style.display = 'block';\n    } else {\n      this.canvas._canvas.style.display = 'none';\n    }\n  };\n\n  BaseLayer.prototype.getWidth = function () {\n    if (this.parent) {\n      return this.parent.width();\n    }\n  };\n\n  BaseLayer.prototype.setWidth = function () {\n    Util_1.Util.warn('Can not change width of layer. Use \"stage.width(value)\" function instead.');\n  };\n\n  BaseLayer.prototype.getHeight = function () {\n    if (this.parent) {\n      return this.parent.height();\n    }\n  };\n\n  BaseLayer.prototype.setHeight = function () {\n    Util_1.Util.warn('Can not change height of layer. Use \"stage.height(value)\" function instead.');\n  };\n\n  BaseLayer.prototype.getIntersection = function (pos, selector) {\n    return null;\n  };\n\n  BaseLayer.prototype.batchDraw = function () {\n    var _this = this;\n\n    if (!this._waitingForDraw) {\n      this._waitingForDraw = true;\n      Util_1.Util.requestAnimFrame(function () {\n        _this.draw();\n\n        _this._waitingForDraw = false;\n      });\n    }\n\n    return this;\n  };\n\n  BaseLayer.prototype._applyTransform = function (shape, context, top) {\n    var m = shape.getAbsoluteTransform(top).getMatrix();\n    context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n  };\n\n  return BaseLayer;\n}(Container_1.Container);\n\nexports.BaseLayer = BaseLayer;\nBaseLayer.prototype.nodeType = 'BaseLayer';\nFactory_1.Factory.addGetterSetter(BaseLayer, 'clearBeforeDraw', true);\nUtil_1.Collection.mapMethods(BaseLayer);","map":{"version":3,"sources":["/home/daniel/reatret.net/react-app/node_modules/konva/lib/BaseLayer.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","defineProperty","exports","value","Util_1","require","Container_1","Node_1","Factory_1","Canvas_1","BaseLayer","_super","config","_this","call","canvas","SceneCanvas","_waitingForDraw","on","_checkVisibility","createPNGStream","c","_canvas","getCanvas","getHitCanvas","hitCanvas","getContext","clear","bounds","setZIndex","index","stage","getStage","content","removeChild","getChildren","length","insertBefore","appendChild","moveToTop","Node","moveUp","moved","moveDown","children","moveToBottom","getLayer","remove","parentNode","Util","_isInDocument","parent","setSize","_a","width","height","_toKonvaCanvas","getWidth","getHeight","x","undefined","y","visible","style","display","setWidth","warn","setHeight","getIntersection","pos","selector","batchDraw","requestAnimFrame","draw","_applyTransform","shape","context","top","m","getAbsoluteTransform","getMatrix","transform","Container","nodeType","Factory","addGetterSetter","Collection","mapMethods"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Util_1 = require(\"./Util\");\nvar Container_1 = require(\"./Container\");\nvar Node_1 = require(\"./Node\");\nvar Factory_1 = require(\"./Factory\");\nvar Canvas_1 = require(\"./Canvas\");\nvar BaseLayer = (function (_super) {\n    __extends(BaseLayer, _super);\n    function BaseLayer(config) {\n        var _this = _super.call(this, config) || this;\n        _this.canvas = new Canvas_1.SceneCanvas();\n        _this._waitingForDraw = false;\n        _this.on('visibleChange', _this._checkVisibility);\n        _this._checkVisibility();\n        return _this;\n    }\n    BaseLayer.prototype.createPNGStream = function () {\n        var c = this.canvas._canvas;\n        return c.createPNGStream();\n    };\n    BaseLayer.prototype.getCanvas = function () {\n        return this.canvas;\n    };\n    BaseLayer.prototype.getHitCanvas = function () {\n        return this.hitCanvas;\n    };\n    BaseLayer.prototype.getContext = function () {\n        return this.getCanvas().getContext();\n    };\n    BaseLayer.prototype.clear = function (bounds) {\n        this.getContext().clear(bounds);\n        return this;\n    };\n    BaseLayer.prototype.setZIndex = function (index) {\n        _super.prototype.setZIndex.call(this, index);\n        var stage = this.getStage();\n        if (stage) {\n            stage.content.removeChild(this.getCanvas()._canvas);\n            if (index < stage.getChildren().length - 1) {\n                stage.content.insertBefore(this.getCanvas()._canvas, stage.getChildren()[index + 1].getCanvas()._canvas);\n            }\n            else {\n                stage.content.appendChild(this.getCanvas()._canvas);\n            }\n        }\n        return this;\n    };\n    BaseLayer.prototype.moveToTop = function () {\n        Node_1.Node.prototype.moveToTop.call(this);\n        var stage = this.getStage();\n        if (stage) {\n            stage.content.removeChild(this.getCanvas()._canvas);\n            stage.content.appendChild(this.getCanvas()._canvas);\n        }\n        return true;\n    };\n    BaseLayer.prototype.moveUp = function () {\n        var moved = Node_1.Node.prototype.moveUp.call(this);\n        if (!moved) {\n            return false;\n        }\n        var stage = this.getStage();\n        if (!stage) {\n            return false;\n        }\n        stage.content.removeChild(this.getCanvas()._canvas);\n        if (this.index < stage.getChildren().length - 1) {\n            stage.content.insertBefore(this.getCanvas()._canvas, stage.getChildren()[this.index + 1].getCanvas()._canvas);\n        }\n        else {\n            stage.content.appendChild(this.getCanvas()._canvas);\n        }\n        return true;\n    };\n    BaseLayer.prototype.moveDown = function () {\n        if (Node_1.Node.prototype.moveDown.call(this)) {\n            var stage = this.getStage();\n            if (stage) {\n                var children = stage.getChildren();\n                stage.content.removeChild(this.getCanvas()._canvas);\n                stage.content.insertBefore(this.getCanvas()._canvas, children[this.index + 1].getCanvas()._canvas);\n            }\n            return true;\n        }\n        return false;\n    };\n    BaseLayer.prototype.moveToBottom = function () {\n        if (Node_1.Node.prototype.moveToBottom.call(this)) {\n            var stage = this.getStage();\n            if (stage) {\n                var children = stage.getChildren();\n                stage.content.removeChild(this.getCanvas()._canvas);\n                stage.content.insertBefore(this.getCanvas()._canvas, children[1].getCanvas()._canvas);\n            }\n            return true;\n        }\n        return false;\n    };\n    BaseLayer.prototype.getLayer = function () {\n        return this;\n    };\n    BaseLayer.prototype.remove = function () {\n        var _canvas = this.getCanvas()._canvas;\n        Node_1.Node.prototype.remove.call(this);\n        if (_canvas && _canvas.parentNode && Util_1.Util._isInDocument(_canvas)) {\n            _canvas.parentNode.removeChild(_canvas);\n        }\n        return this;\n    };\n    BaseLayer.prototype.getStage = function () {\n        return this.parent;\n    };\n    BaseLayer.prototype.setSize = function (_a) {\n        var width = _a.width, height = _a.height;\n        this.canvas.setSize(width, height);\n        return this;\n    };\n    BaseLayer.prototype._toKonvaCanvas = function (config) {\n        config = config || {};\n        config.width = config.width || this.getWidth();\n        config.height = config.height || this.getHeight();\n        config.x = config.x !== undefined ? config.x : this.x();\n        config.y = config.y !== undefined ? config.y : this.y();\n        return Node_1.Node.prototype._toKonvaCanvas.call(this, config);\n    };\n    BaseLayer.prototype._checkVisibility = function () {\n        var visible = this.visible();\n        if (visible) {\n            this.canvas._canvas.style.display = 'block';\n        }\n        else {\n            this.canvas._canvas.style.display = 'none';\n        }\n    };\n    BaseLayer.prototype.getWidth = function () {\n        if (this.parent) {\n            return this.parent.width();\n        }\n    };\n    BaseLayer.prototype.setWidth = function () {\n        Util_1.Util.warn('Can not change width of layer. Use \"stage.width(value)\" function instead.');\n    };\n    BaseLayer.prototype.getHeight = function () {\n        if (this.parent) {\n            return this.parent.height();\n        }\n    };\n    BaseLayer.prototype.setHeight = function () {\n        Util_1.Util.warn('Can not change height of layer. Use \"stage.height(value)\" function instead.');\n    };\n    BaseLayer.prototype.getIntersection = function (pos, selector) {\n        return null;\n    };\n    BaseLayer.prototype.batchDraw = function () {\n        var _this = this;\n        if (!this._waitingForDraw) {\n            this._waitingForDraw = true;\n            Util_1.Util.requestAnimFrame(function () {\n                _this.draw();\n                _this._waitingForDraw = false;\n            });\n        }\n        return this;\n    };\n    BaseLayer.prototype._applyTransform = function (shape, context, top) {\n        var m = shape.getAbsoluteTransform(top).getMatrix();\n        context.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n    };\n    return BaseLayer;\n}(Container_1.Container));\nexports.BaseLayer = BaseLayer;\nBaseLayer.prototype.nodeType = 'BaseLayer';\nFactory_1.Factory.addGetterSetter(BaseLayer, 'clearBeforeDraw', true);\nUtil_1.Collection.mapMethods(BaseLayer);\n"]},"metadata":{},"sourceType":"script"}